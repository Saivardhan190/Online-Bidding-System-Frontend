<div class="min-h-screen bg-gray-100 py-8">
  <div class="max-w-7xl mx-auto px-4">

    <!-- Header -->
    <div class="mb-8">
      <a routerLink="/admin" class="text-blue-600 hover: underline mb-2 inline-block">â† Back to Admin</a>
      <h1 class="text-3xl font-bold text-gray-900">Manage Users ğŸ‘¥</h1>
      <p class="text-gray-600 mt-1">View and manage all users</p>
    </div>

    <!-- Stats Cards -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
      <div class="bg-white rounded-xl shadow p-4 text-center">
        <p class="text-2xl font-bold text-gray-900">{{ stats.total }}</p>
        <p class="text-sm text-gray-500">Total</p>
      </div>
      <div class="bg-white rounded-xl shadow p-4 text-center">
        <p class="text-2xl font-bold text-blue-600">{{ stats.users }}</p>
        <p class="text-sm text-gray-500">Users</p>
      </div>
      <div class="bg-white rounded-xl shadow p-4 text-center">
        <p class="text-2xl font-bold text-green-600">{{ stats.bidders }}</p>
        <p class="text-sm text-gray-500">Bidders</p>
      </div>
      <div class="bg-white rounded-xl shadow p-4 text-center">
        <p class="text-2xl font-bold text-purple-600">{{ stats.admins }}</p>
        <p class="text-sm text-gray-500">Admins</p>
      </div>
    </div>

    <!-- Search & Filters -->
    <div class="bg-white rounded-xl shadow-lg mb-6">
      <div class="p-4 border-b">
        <div class="relative">
          <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">ğŸ”</span>
          <input 
            type="text" 
            [(ngModel)]="searchQuery"
            (ngModelChange)="onSearchChange()"
            placeholder="Search by name, email, or college ID..."
            class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus: ring-blue-500 focus:border-blue-500"
          >
        </div>
      </div>

      <!-- Tabs -->
      <div class="flex border-b overflow-x-auto">
        @for (tab of tabs; track tab.id) {
          <button
            (click)="setActiveTab(tab.id)"
            [ngClass]="activeTab === tab.id ? 'border-b-2 border-blue-600 text-blue-600 bg-blue-50' : 'text-gray-500 hover:bg-gray-50'"
            class="flex-1 min-w-max px-6 py-4 font-medium transition flex items-center justify-center gap-2"
          >
            <span>{{ tab.icon }}</span>
            <span>{{ tab. label }}</span>
          </button>
        }
      </div>

      <!-- Users List -->
      <div class="p-6">
        @if (isLoading) {
          <div class="flex justify-center py-12">
            <div class="w-12 h-12 border-4 border-blue-200 rounded-full animate-spin border-t-blue-600"></div>
          </div>
        } @else if (filteredUsers. length > 0) {
          <div class="overflow-x-auto">
            <table class="w-full">
              <thead>
                <tr class="text-left text-gray-500 text-sm border-b">
                  <th class="pb-3 font-medium">User</th>
                  <th class="pb-3 font-medium hidden md:table-cell">College ID</th>
                  <th class="pb-3 font-medium hidden lg:table-cell">Department</th>
                  <th class="pb-3 font-medium">Role</th>
                  <th class="pb-3 font-medium hidden md:table-cell">Status</th>
                  <th class="pb-3 font-medium text-right">Actions</th>
                </tr>
              </thead>
              <tbody>
                @for (user of filteredUsers; track user. studentId) {
                  <tr class="border-b hover:bg-gray-50">
                    <td class="py-4">
                      <div class="flex items-center">
                        <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full flex items-center justify-center mr-3 overflow-hidden">
                          @if (user.profilePicture) {
                            <img [src]="user. profilePicture" class="w-full h-full object-cover" alt="Profile">
                          } @else {
                            <span class="text-white font-bold">{{ getUserInitial(user) }}</span>
                          }
                        </div>
                        <div>
                          <p class="font-medium text-gray-900">{{ user.studentName }}</p>
                          <p class="text-sm text-gray-500">{{ user. studentEmail }}</p>
                        </div>
                      </div>
                    </td>
                    <td class="py-4 hidden md:table-cell text-gray-600">{{ user.collageId || 'N/A' }}</td>
                    <td class="py-4 hidden lg:table-cell text-gray-600">{{ user. department || 'N/A' }}</td>
                    <td class="py-4">
                      <select 
                        [value]="user. role"
                        (change)="changeRole(user, $any($event.target).value)"
                        class="px-3 py-1 rounded-full text-sm font-medium border-0 cursor-pointer"
                        [ngClass]="getRoleBadge(user.role || 'USER').class"
                      >
                        <option value="USER">User</option>
                        <option value="BIDDER">Bidder</option>
                        <option value="ADMIN">Admin</option>
                      </select>
                    </td>
                    <td class="py-4 hidden md:table-cell">
                      <span 
                        [ngClass]="user.isActive !== false ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'"
                        class="px-3 py-1 rounded-full text-sm font-medium"
                      >
                        {{ user.isActive !== false ? 'Active' : 'Inactive' }}
                      </span>
                    </td>
                    <td class="py-4 text-right">
                      <button 
                        (click)="toggleStatus(user)"
                        class="text-gray-600 hover:text-gray-900 mr-2 p-1"
                        [title]="user.isActive !== false ? 'Deactivate User' : 'Activate User'"
                      >
                        {{ user.isActive !== false ? 'ğŸ”’' : 'ğŸ”“' }}
                      </button>
                    </td>
                  </tr>
                }
              </tbody>
            </table>
          </div>
        } @else {
          <div class="text-center py-12">
            <span class="text-6xl block mb-4">ğŸ‘¥</span>
            <h3 class="text-xl font-semibold text-gray-900 mb-2">No users found</h3>
            <p class="text-gray-500">No users match your search criteria. </p>
          </div>
        }
      </div>
    </div>
  </div>
</div>